# Проект "Бюро находок"

## Запуск проекта

1. Создайте виртуальное окружение
2. Установите зависимости из файла requirements.txt
3. Создайте файл .env.local, используя .env.local.examples
4. Создайте DB, используя параметры из .env.local
5. Примените миграции
    ```bash
   alembic upgrade head 
    ```
6. Запустите сервер
   ```bash
   uvicorn main:app --reload
   ```

## Запуск автотестов

1. Создайте тестовую DB, используя параметры из .env.local
2. Запустите автотесты
   ```bash
   pytest -v
   ```


# History

## Урок 10

- добавили зависимости в `requirements.txt`
- создали `.gitignore`

**commit: `Урок 10: init`**

### 1. Основные файлы и конфигурация

- **`main.py`**:
  - Этот файл является точкой входа в ваше FastAPI приложение.
  - Он инициализирует приложение FastAPI и подключает маршрутизаторы (`routers`) для обработки запросов, связанных с потерянными и найденными предметами.
  - Содержит базовый эндпоинт `/`, который возвращает приветственное сообщение.

- **`config.py`**:
  - Содержит настройки приложения, такие как параметры подключения к базе данных.
  - Использует Pydantic для валидации и загрузки переменных окружения из файла `.env.local`.

- **`.env.local.example`**:
  - Пример файла переменных окружения, который используется для настройки параметров базы данных и других конфигураций.
  - Пользователи должны создать файл `.env.local` на основе этого примера и заполнить его своими данными.

### 2. База данных и модели

- **`database.py`**:
  - Настраивает подключение к базе данных с использованием SQLAlchemy.
  - Создает асинхронный движок и сессию для взаимодействия с базой данных.

- **`models.py`**:
  - Определяет модели данных для таблиц `lost_items` и `found_items`.
  - Использует SQLAlchemy ORM для определения структуры таблиц и их полей.
  - Каждая модель соответствует таблице в базе данных и определяет поля, такие как `id`, `name`, `description`, `date`, и `location`.

### 3. Маршрутизаторы и эндпоинты

- **`routers/lost_items.py` и `routers/found_items.py`**:
  - Определяют маршрутизаторы для обработки HTTP-запросов, связанных с потерянными и найденными предметами.
  - Каждый маршрутизатор содержит CRUD (Create, Read, Update, Delete) операции для соответствующих моделей.
  - Используют Pydantic схемы для валидации входных данных и сериализации ответов.

### 4. Схемы данных

- **`schemas.py`**:
  - Определяет Pydantic схемы для валидации данных, поступающих в API, и для сериализации данных, возвращаемых из API.
  - Содержит схемы для создания, обновления и чтения потерянных и найденных предметов.

### 5. Тестирование

- **`conftest.py`**:
  - Содержит фикстуры для настройки тестовой базы данных и клиента FastAPI.
  - Использует `pytest` и `pytest-asyncio` для асинхронного тестирования.
  - Фикстуры обеспечивают изоляцию тестов, создавая и уничтожая тестовую базу данных перед и после выполнения тестов.

- **`test_found_items.py` и `test_lost_items.py`**:
  - Содержат тесты для проверки функциональности эндпоинтов, связанных с найденными и потерянными предметами.
  - Включают тесты для создания, чтения, обновления и удаления предметов, а также проверки на корректность обработки ошибок (например, когда предмет не найден).

### 6. Миграции базы данных

- **`alembic.ini` и `alembic/env.py`**:
  - Конфигурационные файлы для Alembic, инструмента для управления миграциями базы данных.
  - `alembic.ini` содержит основные настройки, такие как путь к скриптам миграций.
  - `env.py` настраивает окружение для выполнения миграций, подключаясь к базе данных и используя метаданные моделей.

- **`789953bf9c87_init_migrations.py`**:
  - Автоматически сгенерированная миграция, которая создает таблицы `found_items` и `lost_items` в базе данных.
  - Содержит команды для создания и удаления таблиц и индексов.

**commit: `Урок 10: создан простой FastAPI проект`**